---
import Layout from "../layouts/BaseLayout.astro";
import RegisterForm from "../components/auth/RegisterForm";
import StatusModal from "../components/ui/StatusModal.astro";
import { getSession } from "../lib/auth";
import "../styles/auth.css";

let session = null;
try {
    session = await getSession(Astro.request);
} catch (e) {
    console.error("Cadastro Page Auth Error:", e);
}
if (session) {
    return Astro.redirect("/dashboard");
}
export const prerender = false;
---

<Layout
    title="Cadastre-se | Alpha Code"
    showHeader={false}
    showFooter={false}
    showWhatsApp={false}
>
    <!-- The split-screen layout is now handled inside the RegisterForm component -->
    <RegisterForm client:load />

    <StatusModal
        id="register-status-modal"
        title="Validando..."
        message="Criando sua conta Alpha"
        type="loading"
    />
</Layout>
